"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[366],{97760:function(ce,B,a){a.r(B),a.d(B,{default:function(){return re}});var z=a(43953),d=a.n(z),N=a(39346),h=a.n(N),W=a(91184),v=a.n(W),$=a(9083),Z=a.n($),R=a(54175),D=a(20835),t=a(23539);function E(f,r){return j.apply(this,arguments)}function j(){return j=v()(d()().mark(function f(r,o){return d()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",(0,t.request)("/api/login/captcha",h()({method:"GET",params:h()({},r)},o||{})));case 1:case"end":return p.stop()}},f)})),j.apply(this,arguments)}var G=a(37679),H=a(50492),V=a(65633),w=a(19357),T=a(3294),K=a(31455),Q=a(31282),F=a(55205),J=a(7650),X=a(66947),Y=a(39240),S=a(25805),k=a(5027),q=a(34174),A=a(38497),_=a(2060),ee=a(51089),e=a(96469),L=(0,q.kc)(function(f){var r=f.token;return{action:{marginLeft:"8px",color:"rgba(0, 0, 0, 0.2)",fontSize:"24px",verticalAlign:"middle",cursor:"pointer",transition:"color 0.3s","&:hover":{color:r.colorPrimaryActive}},lang:{width:42,height:42,lineHeight:"42px",position:"fixed",right:16,borderRadius:r.borderRadius,":hover":{backgroundColor:r.colorBgTextHover}},loginLeft:{display:"flex",flexDirection:"column",minWidth:"50%",height:"100vh",overflow:"auto",backgroundSize:"100% 100%"},container:{display:"flex",flexDirection:"column",width:"auto",height:"100vh",overflow:"auto",backgroundSize:"100% 100%"}}}),ae=function(){var r=L(),o=r.styles;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(G.Z,{className:o.action},"AlipayCircleOutlined"),(0,e.jsx)(H.Z,{className:o.action},"TaobaoCircleOutlined"),(0,e.jsx)(V.Z,{className:o.action},"WeiboCircleOutlined")]})},se=function(){var r=L(),o=r.styles;return(0,e.jsx)("div",{className:o.lang,"data-lang":!0,children:t.SelectLang&&(0,e.jsx)(t.SelectLang,{})})},P=function(r){var o=r.content;return(0,e.jsx)(Y.Z,{style:{marginBottom:24},message:o,type:"error",showIcon:!0})},te=function(){var r=(0,A.useState)({}),o=Z()(r,2),C=o[0],p=o[1],ne=(0,A.useState)("account"),I=Z()(ne,2),x=I[0],ie=I[1],U=(0,t.useModel)("@@initialState"),M=U.initialState,le=U.setInitialState,oe=L(),ue=oe.styles,i=(0,t.useIntl)(),ge=function(){var m=v()(d()().mark(function l(){var u,g;return d()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,M==null||(u=M.fetchUserInfo)===null||u===void 0?void 0:u.call(M);case 2:g=s.sent,g&&(0,_.flushSync)(function(){le(function(y){return h()(h()({},y),{},{currentUser:g})})});case 4:case"end":return s.stop()}},l)}));return function(){return m.apply(this,arguments)}}(),de=function(){var m=v()(d()().mark(function l(u){var g,c,s,y;return d()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,console.log(">>> Login"),n.next=4,(0,D.x4)(h()(h()({},u),{},{type:x}));case 4:if(g=n.sent,g.status!=="ok"){n.next=13;break}return c=i.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"}),S.ZP.success(c),n.next=10,ge();case 10:return s=new URL(window.location.href).searchParams,t.history.push(s.get("redirect")||"/"),n.abrupt("return");case 13:console.log(g),p(g),n.next=22;break;case 17:n.prev=17,n.t0=n.catch(0),y=i.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),console.log(n.t0),S.ZP.error(y);case 22:case"end":return n.stop()}},l,null,[[0,17]])}));return function(u){return m.apply(this,arguments)}}(),O=C.status,b=C.type;return(0,e.jsxs)("div",{className:ue.container,children:[(0,e.jsx)(t.Helmet,{children:(0,e.jsxs)("title",{children:[i.formatMessage({id:"menu.login",defaultMessage:"\u767B\u5F55\u9875"}),"- ",ee.Z.title]})}),(0,e.jsx)(se,{}),(0,e.jsx)("div",{style:{flex:"1",padding:"32px 0"},children:(0,e.jsxs)(Q.U,{contentStyle:{minWidth:280,maxWidth:"75vw"},logo:(0,e.jsx)("img",{alt:"logo",src:"/logo.svg"}),title:"WisQo",subTitle:i.formatMessage({id:"pages.layouts.userLayout.title"}),initialValues:{autoLogin:!0},actions:[(0,e.jsx)(t.FormattedMessage,{id:"pages.login.loginWith",defaultMessage:"\u5176\u4ED6\u767B\u5F55\u65B9\u5F0F"},"loginWith"),(0,e.jsx)(ae,{},"icons")],onFinish:function(){var m=v()(d()().mark(function l(u){return d()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,de(u);case 2:case"end":return c.stop()}},l)}));return function(l){return m.apply(this,arguments)}}(),children:[(0,e.jsx)(k.Z,{activeKey:x,onChange:ie,centered:!0,items:[{key:"account",label:i.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"\u8D26\u6237\u5BC6\u7801\u767B\u5F55"})},{key:"mobile",label:i.formatMessage({id:"pages.login.phoneLogin.tab",defaultMessage:"\u624B\u673A\u53F7\u767B\u5F55"})}]}),O==="error"&&b==="account"&&(0,e.jsx)(P,{content:i.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF(admin/ant.design)"})}),x==="account"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(F.Z,{name:"identifier",fieldProps:{size:"large",prefix:(0,e.jsx)(w.Z,{})},placeholder:i.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u7528\u6237\u540D: admin"}),rules:[{required:!0,message:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,e.jsx)(F.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,e.jsx)(T.Z,{})},placeholder:i.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u5BC6\u7801: ant.design"}),rules:[{required:!0,message:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]}),O==="error"&&b==="mobile"&&(0,e.jsx)(P,{content:"\u9A8C\u8BC1\u7801\u9519\u8BEF"}),x==="mobile"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(F.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(K.Z,{})},name:"mobile",placeholder:i.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"\u624B\u673A\u53F7"}),rules:[{required:!0,message:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.phoneNumber.required",defaultMessage:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"})},{pattern:/^1\d{10}$/,message:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.phoneNumber.invalid",defaultMessage:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"})}]}),(0,e.jsx)(J.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(T.Z,{})},captchaProps:{size:"large"},placeholder:i.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}),captchaTextRender:function(l,u){return l?"".concat(u," ").concat(i.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})):i.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})},name:"captcha",rules:[{required:!0,message:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.captcha.required",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"})}],onGetCaptcha:function(){var m=v()(d()().mark(function l(u){var g;return d()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,E({phone:u});case 2:if(g=s.sent,g){s.next=5;break}return s.abrupt("return");case 5:S.ZP.success("\u83B7\u53D6\u9A8C\u8BC1\u7801\u6210\u529F\uFF01\u9A8C\u8BC1\u7801\u4E3A\uFF1A1234");case 6:case"end":return s.stop()}},l)}));return function(l){return m.apply(this,arguments)}}()})]}),(0,e.jsxs)("div",{style:{marginBottom:24},children:[(0,e.jsx)(X.Z,{noStyle:!0,name:"autoLogin",children:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.rememberMe",defaultMessage:"\u81EA\u52A8\u767B\u5F55"})}),(0,e.jsx)("a",{style:{float:"right"},children:(0,e.jsx)(t.FormattedMessage,{id:"pages.login.forgotPassword",defaultMessage:"\u5FD8\u8BB0\u5BC6\u7801"})})]})]})}),(0,e.jsx)(R.$_,{})]})},re=te}}]);
