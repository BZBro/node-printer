"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[70],{30367:function(dr,me,i){i.r(me),i.d(me,{default:function(){return ar}});var we=i(43953),S=i.n(we),De=i(91184),U=i.n(De),Ne=i(9083),N=i.n(Ne),Ze=i(23539),Q=i(25805),A=i(91841),fe=i(23273),W=i(14805),ge=i(49227),L=i(59725),Be=i(48965),d=i(38497),ze=i(26869),G=i.n(ze),he=i(17295),Re=i(50962),y=i(61894),Ae=i(82486),Fe=i(71257),He=i(51699);const Me=e=>{const{componentCls:r,calc:a}=e;return{[r]:Object.assign(Object.assign({},(0,Ae.Wf)(e)),{margin:0,padding:0,listStyle:"none",[`${r}-item`]:{position:"relative",margin:0,paddingBottom:e.itemPaddingBottom,fontSize:e.fontSize,listStyle:"none","&-tail":{position:"absolute",insetBlockStart:e.itemHeadSize,insetInlineStart:a(a(e.itemHeadSize).sub(e.tailWidth)).div(2).equal(),height:`calc(100% - ${(0,y.bf)(e.itemHeadSize)})`,borderInlineStart:`${(0,y.bf)(e.tailWidth)} ${e.lineType} ${e.tailColor}`},"&-pending":{[`${r}-item-head`]:{fontSize:e.fontSizeSM,backgroundColor:"transparent"},[`${r}-item-tail`]:{display:"none"}},"&-head":{position:"absolute",width:e.itemHeadSize,height:e.itemHeadSize,backgroundColor:e.dotBg,border:`${(0,y.bf)(e.dotBorderWidth)} ${e.lineType} transparent`,borderRadius:"50%","&-blue":{color:e.colorPrimary,borderColor:e.colorPrimary},"&-red":{color:e.colorError,borderColor:e.colorError},"&-green":{color:e.colorSuccess,borderColor:e.colorSuccess},"&-gray":{color:e.colorTextDisabled,borderColor:e.colorTextDisabled}},"&-head-custom":{position:"absolute",insetBlockStart:a(e.itemHeadSize).div(2).equal(),insetInlineStart:a(e.itemHeadSize).div(2).equal(),width:"auto",height:"auto",marginBlockStart:0,paddingBlock:e.customHeadPaddingVertical,lineHeight:1,textAlign:"center",border:0,borderRadius:0,transform:"translate(-50%, -50%)"},"&-content":{position:"relative",insetBlockStart:a(a(e.fontSize).mul(e.lineHeight).sub(e.fontSize)).mul(-1).add(e.lineWidth).equal(),marginInlineStart:a(e.margin).add(e.itemHeadSize).equal(),marginInlineEnd:0,marginBlockStart:0,marginBlockEnd:0,wordBreak:"break-word"},"&-last":{[`> ${r}-item-tail`]:{display:"none"},[`> ${r}-item-content`]:{minHeight:a(e.controlHeightLG).mul(1.2).equal()}}},[`&${r}-alternate,
        &${r}-right,
        &${r}-label`]:{[`${r}-item`]:{"&-tail, &-head, &-head-custom":{insetInlineStart:"50%"},"&-head":{marginInlineStart:a(e.marginXXS).mul(-1).equal(),"&-custom":{marginInlineStart:a(e.tailWidth).div(2).equal()}},"&-left":{[`${r}-item-content`]:{insetInlineStart:`calc(50% - ${(0,y.bf)(e.marginXXS)})`,width:`calc(50% - ${(0,y.bf)(e.marginSM)})`,textAlign:"start"}},"&-right":{[`${r}-item-content`]:{width:`calc(50% - ${(0,y.bf)(e.marginSM)})`,margin:0,textAlign:"end"}}}},[`&${r}-right`]:{[`${r}-item-right`]:{[`${r}-item-tail,
            ${r}-item-head,
            ${r}-item-head-custom`]:{insetInlineStart:`calc(100% - ${(0,y.bf)(a(a(e.itemHeadSize).add(e.tailWidth)).div(2).equal())})`},[`${r}-item-content`]:{width:`calc(100% - ${(0,y.bf)(a(e.itemHeadSize).add(e.marginXS).equal())})`}}},[`&${r}-pending
        ${r}-item-last
        ${r}-item-tail`]:{display:"block",height:`calc(100% - ${(0,y.bf)(e.margin)})`,borderInlineStart:`${(0,y.bf)(e.tailWidth)} dotted ${e.tailColor}`},[`&${r}-reverse
        ${r}-item-last
        ${r}-item-tail`]:{display:"none"},[`&${r}-reverse ${r}-item-pending`]:{[`${r}-item-tail`]:{insetBlockStart:e.margin,display:"block",height:`calc(100% - ${(0,y.bf)(e.margin)})`,borderInlineStart:`${(0,y.bf)(e.tailWidth)} dotted ${e.tailColor}`},[`${r}-item-content`]:{minHeight:a(e.controlHeightLG).mul(1.2).equal()}},[`&${r}-label`]:{[`${r}-item-label`]:{position:"absolute",insetBlockStart:a(a(e.fontSize).mul(e.lineHeight).sub(e.fontSize)).mul(-1).add(e.tailWidth).equal(),width:`calc(50% - ${(0,y.bf)(e.marginSM)})`,textAlign:"end"},[`${r}-item-right`]:{[`${r}-item-label`]:{insetInlineStart:`calc(50% + ${(0,y.bf)(e.marginSM)})`,width:`calc(50% - ${(0,y.bf)(e.marginSM)})`,textAlign:"start"}}},"&-rtl":{direction:"rtl",[`${r}-item-head-custom`]:{transform:"translate(50%, -50%)"}}})}},Ue=e=>({tailColor:e.colorSplit,tailWidth:e.lineWidthBold,dotBorderWidth:e.wireframe?e.lineWidthBold:e.lineWidth*3,dotBg:e.colorBgContainer,itemPaddingBottom:e.padding*1.25});var We=(0,Fe.I$)("Timeline",e=>{const r=(0,He.IX)(e,{itemHeadSize:10,customHeadPaddingVertical:e.paddingXXS,paddingInlineEnd:2});return[Me(r)]},Ue),Le=function(e,r){var a={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.indexOf(t)<0&&(a[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,t=Object.getOwnPropertySymbols(e);n<t.length;n++)r.indexOf(t[n])<0&&Object.prototype.propertyIsEnumerable.call(e,t[n])&&(a[t[n]]=e[t[n]]);return a},pe=e=>{var{prefixCls:r,className:a,color:t="blue",dot:n,pending:P=!1,position:p,label:I,children:Z}=e,x=Le(e,["prefixCls","className","color","dot","pending","position","label","children"]);const{getPrefixCls:u}=d.useContext(he.E_),f=u("timeline",r),B=G()(`${f}-item`,{[`${f}-item-pending`]:P},a),T=/blue|red|green|gray/.test(t||"")?void 0:t,h=G()(`${f}-item-head`,{[`${f}-item-head-custom`]:!!n,[`${f}-item-head-${t}`]:!T});return d.createElement("li",Object.assign({},x,{className:B}),I&&d.createElement("div",{className:`${f}-item-label`},I),d.createElement("div",{className:`${f}-item-tail`}),d.createElement("div",{className:h,style:{borderColor:T,color:T}},n),d.createElement("div",{className:`${f}-item-content`},Z))},Ge=i(92507),Xe=i(25915),ve=function(e,r){var a={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.indexOf(t)<0&&(a[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,t=Object.getOwnPropertySymbols(e);n<t.length;n++)r.indexOf(t[n])<0&&Object.prototype.propertyIsEnumerable.call(e,t[n])&&(a[t[n]]=e[t[n]]);return a},Ve=e=>{var{prefixCls:r,className:a,pending:t=!1,children:n,items:P,rootClassName:p,reverse:I=!1,direction:Z,hashId:x,pendingDot:u,mode:f=""}=e,B=ve(e,["prefixCls","className","pending","children","items","rootClassName","reverse","direction","hashId","pendingDot","mode"]);const T=(c,w)=>f==="alternate"?c==="right"?`${r}-item-right`:c==="left"?`${r}-item-left`:w%2===0?`${r}-item-left`:`${r}-item-right`:f==="left"?`${r}-item-left`:f==="right"?`${r}-item-right`:c==="right"?`${r}-item-right`:"",h=(0,Ge.Z)(P||[]),z=typeof t=="boolean"?null:t;t&&h.push({pending:!!t,dot:u||d.createElement(Xe.Z,null),children:z}),I&&h.reverse();const q=h.length,V=`${r}-item-last`,ae=h.filter(c=>!!c).map((c,w)=>{var F;const ne=w===q-2?V:"",_=w===q-1?V:"",{className:le}=c,se=ve(c,["className"]);return d.createElement(pe,Object.assign({},se,{className:G()([le,!I&&t?ne:_,T((F=c==null?void 0:c.position)!==null&&F!==void 0?F:"",w)]),key:(c==null?void 0:c.key)||w}))}),k=h.some(c=>!!(c!=null&&c.label)),ie=G()(r,{[`${r}-pending`]:!!t,[`${r}-reverse`]:!!I,[`${r}-${f}`]:!!f&&!k,[`${r}-label`]:k,[`${r}-rtl`]:Z==="rtl"},a,p,x);return d.createElement("ul",Object.assign({},B,{className:ie}),ae)},Ye=i(10469);function Je(e,r){return e&&Array.isArray(e)?e:(0,Ye.Z)(r).map(a=>{var t,n;return Object.assign({children:(n=(t=a==null?void 0:a.props)===null||t===void 0?void 0:t.children)!==null&&n!==void 0?n:""},a.props)})}var Ke=Je,Qe=function(e,r){var a={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.indexOf(t)<0&&(a[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,t=Object.getOwnPropertySymbols(e);n<t.length;n++)r.indexOf(t[n])<0&&Object.prototype.propertyIsEnumerable.call(e,t[n])&&(a[t[n]]=e[t[n]]);return a};const be=e=>{const{getPrefixCls:r,direction:a,timeline:t}=d.useContext(he.E_),{prefixCls:n,children:P,items:p,className:I,style:Z}=e,x=Qe(e,["prefixCls","children","items","className","style"]),u=r("timeline",n),f=(0,Re.Z)(u),[B,T,h]=We(u,f),z=Ke(p,P);return B(d.createElement(Ve,Object.assign({},x,{className:G()(t==null?void 0:t.className,I,h,f),style:Object.assign(Object.assign({},t==null?void 0:t.style),Z),prefixCls:u,direction:a,items:z,hashId:T})))};be.Item=pe;var qe=be,ke=qe,o=i(96469),_e=i(1982).lW,ye={GET_UUID:"get-uuid",GET_DETAIL:"get-detail"},er={1:"blue",2:"red",3:"green",4:"gray"},rr=ye.GET_UUID,X=[],tr=function(){var r=(0,d.useRef)(null),a={baudRate:115200,dataBits:8,stopBits:1,parity:"none",bufferSize:1024,flowControl:"none"},t=(0,Ze.useIntl)(),n=(0,d.useState)(),P=N()(n,2),p=P[0],I=P[1],Z=(0,d.useState)(void 0),x=N()(Z,2),u=x[0],f=x[1],B=(0,d.useState)(!1),T=N()(B,2),h=T[0],z=T[1],q=(0,d.useState)("\u65E0\u8BBE\u5907\u8FDE\u63A5"),V=N()(q,2),ae=V[0],k=V[1],ie=(0,d.useState)("\u65E0\u72B6\u6001"),c=N()(ie,2),w=c[0],F=c[1],ne=(0,d.useState)([]),_=N()(ne,2),le=_[0],se=_[1],ir=(0,d.useState)("".concat(t.formatMessage({id:"pages.terminal.xxx",defaultMessage:"\u8BF7\u5148 \u8FDE\u63A5\u2191 \u7AEF\u53E3"}))),Se=N()(ir,2),nr=Se[0],$e=Se[1],lr="ds-terminal1",mr=new TextEncoder,sr=function($){for(var m="",v=0;v<$.length;v+=2){var l=parseInt($.substr(v,2),16);m+=String.fromCharCode(l)}return m};(0,d.useEffect)(function(){navigator.serial||Q.ZP.warning("\u5F53\u524D\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u4E32\u53E3\u64CD\u4F5C,\u8BF7\u66F4\u6362Edge\u6216Chrome\u6D4F\u89C8\u5668")},[]),(0,d.useMemo)(function(){var j=function(){var $=U()(S()().mark(function m(){var v,l;return S()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:v=8192,l=S()().mark(function O(){var s,Ie;return S()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:g.prev=0;try{r.current=p.readable.getReader({mode:"byob"})}catch(ee){r.current=p.readable.getReader()}s=null,Ie=S()().mark(function ee(){var oe,H,Te,de,je,re,ue,M,Oe,Ee,Y,te,Pe,J;return S()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,U()(S()().mark(function D(){var ce,K,xe;return S()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(!(r.current instanceof ReadableStreamBYOBReader)){E.next=11;break}return s||(s=new ArrayBuffer(v)),E.next=4,r.current.read(new Uint8Array(s,0,v));case 4:return ce=E.sent,K=ce.value,xe=ce.done,s=K==null?void 0:K.buffer,E.abrupt("return",{value:K,done:xe});case 11:return E.next=13,r.current.read();case 13:return E.abrupt("return",E.sent);case 14:case"end":return E.stop()}},D)}))();case 2:if(oe=b.sent,H=oe.value,Te=oe.done,!H){b.next=34;break}if(!(H.length>=0)){b.next=32;break}if(de=H.subarray(0,H.length),!(de.length>0)){b.next=32;break}if(je=_e.from(de).toString("hex"),re=sr(je),!re.includes("$$$")){b.next=32;break}ue=re.indexOf("$$$"),M=re.substring(ue+3,ue+11),k(M),Oe=new Request("http://localhost:8700/print-sensor-uuid",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({deviceId:M})}),Ee={label:(0,o.jsx)(A.Z.Text,{style:{fontSize:15},children:new Date().toLocaleString()}),color:er[Math.round(Math.random()*4).toString()],children:(0,o.jsxs)(A.Z.Text,{style:{fontSize:20,color:"blue "},children:["\u6253\u5370 ",(0,o.jsx)("span",{style:{fontSize:20,color:"blue "},children:M})]})},Y=[],te=X,X.length>10&&(Pe=X.length-10,te=X.slice(Pe)),J=0;case 21:if(!(J<te.length)){b.next=28;break}if(!(J>10)){b.next=24;break}return b.abrupt("break",28);case 24:Y.push(te[J]);case 25:J++,b.next=21;break;case 28:Y.push(Ee),X=Y,se(Y),fetch(Oe).then(function(D){return D.json()}).then(function(D){F("\u6253\u5370 ".concat(M," \u6210\u529F"))}).catch(function(D){console.log(D),F("\u6253\u5370 ".concat(M," \u5931\u8D25"))});case 32:return b.next=34,new Promise(function(D){u==null||u.writeString(H,D)});case 34:if(!Te){b.next=36;break}return b.abrupt("return",1);case 36:case"end":return b.stop()}},ee)});case 4:return g.delegateYield(Ie(),"t0",5);case 5:if(!g.t0){g.next=7;break}return g.abrupt("break",9);case 7:g.next=4;break;case 9:g.next=16;break;case 11:return g.prev=11,g.t1=g.catch(0),console.error(g.t1),g.next=16,new Promise(function(ee){g.t1 instanceof Error&&(u==null||u.writeString("<ERROR: ".concat(g.t1.message,">"),ee))});case 16:return g.prev=16,r.current&&(r.current.releaseLock(),r.current=void 0),g.finish(16);case 19:case"end":return g.stop()}},O,null,[[0,11,16,19]])});case 2:if(!(p&&p!==null&&p!==void 0&&p.readable)){C.next=6;break}return C.delegateYield(l(),"t0",4);case 4:C.next=2;break;case 6:case"end":return C.stop()}},m)}));return function(){return $.apply(this,arguments)}}();h&&(r.current||j().then())},[h]);var Ce=function(){var j=U()(S()().mark(function $(){var m;return S()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(p&&u)){l.next=18;break}if(!u){l.next=18;break}return l.next=4,(m=r.current)===null||m===void 0?void 0:m.cancel();case 4:return l.prev=4,l.next=7,p.close();case 7:return l.next=9,p.forget();case 9:I(void 0),$e("\u672A\u9009\u62E9\u4E32\u53E3"),l.next=17;break;case 13:l.prev=13,l.t0=l.catch(4),console.error(l.t0),l.t0 instanceof Error&&u.writeln("<ERROR: ".concat(l.t0.message,">"));case 17:z(!1);case 18:case"end":return l.stop()}},$,null,[[4,13]])}));return function(){return j.apply(this,arguments)}}(),fr=function(){var j=U()(S()().mark(function $(){var m,v,l,R;return S()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(rr=ye.GET_UUID,!(p&&p.writable)){O.next=12;break}if(m="CC01001320FFFFFFFF00F000000000FFFFFFFF3EAA".replace(/\s+/g,""),!(/^[0-9A-Fa-f]+$/.test(m)&&m.length%2===0)){O.next=10;break}for(v=[],l=0;l<m.length;l=l+2)v.push(parseInt(m.substring(l,l+2),16));return R=p.writable.getWriter(),R.write(Uint8Array.from(v)),R.releaseLock(),O.abrupt("return");case 10:return Q.ZP.warning("\u8BF7\u8F93\u5165\u6709\u6548\u4FE1\u606F"),O.abrupt("return");case 12:case"end":return O.stop()}},$)}));return function(){return j.apply(this,arguments)}}(),or=function(){var j=U()(S()().mark(function $(){var m,v,l,R,C;return S()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,Ce(),s.next=4,navigator.serial.requestPort();case 4:if(m=s.sent,!m){s.next=30;break}return v=m.getInfo(),$e("".concat(t.formatMessage({id:"pages.terminal.xxx",defaultMessage:"Selected"})," : ").concat(v.usbProductId,"-").concat(v.usbVendorId)),I(m),s.prev=9,s.next=12,m.open(a);case 12:if(u){s.next=23;break}return s.next=15,Promise.all([i.e(856),i.e(961)]).then(i.bind(i,4172));case 15:l=s.sent,R=l.TerminalClass,C=new R({theme:{selectionBackground:"#f4ea2a"}},lr),f(C),C==null||C.writeln("<CONNECTED>"),z(!0),s.next=25;break;case 23:u==null||u.writeln("<CONNECTED>"),z(!0);case 25:s.next=30;break;case 27:s.prev=27,s.t0=s.catch(9),s.t0 instanceof Error&&Q.ZP.error("\u4E32\u53E3\u5F02\u5E38\u5173\u95ED\uFF0C\u8BF7\u5237\u65B0\u9875\u9762 "+s.t0.message);case 30:s.next=35;break;case 32:s.prev=32,s.t1=s.catch(0),s.t1 instanceof Error&&Q.ZP.error("".concat(t.formatMessage({id:"pages.terminal.xxx",defaultMessage:"Get serial port error"})," : ").concat(s.t1.message));case 35:case"end":return s.stop()}},$,null,[[0,32],[9,27]])}));return function(){return j.apply(this,arguments)}}();return(0,o.jsxs)(fe.Z,{gutter:8,style:{display:"flex",flexDirection:"row",justifyContent:"flex-start"},children:[(0,o.jsxs)(W.Z,{span:6,style:{display:"flex",flexDirection:"column",justifyContent:"flex-start",paddingRight:8,borderRadius:2,minHeight:"40rem"},children:[(0,o.jsxs)(fe.Z,{gutter:8,style:{marginTop:0},children:[(0,o.jsx)(W.Z,{span:12,children:(0,o.jsx)(ge.ZP,{type:"primary",disabled:!!h,onClick:function(){return or()},style:{width:"100%"},children:t.formatMessage({id:"pages.terminal.xxx",defaultMessage:"\u8FDE\u63A5"})})}),(0,o.jsx)(W.Z,{span:12,children:(0,o.jsx)(ge.ZP,{type:"primary",disabled:!h,onClick:function(){return Ce()},style:{width:"100%"},children:t.formatMessage({id:"pages.terminal.xxx",defaultMessage:"\u5173\u95ED"})})})]}),(0,o.jsx)(L.Z,{style:{height:"66px",width:"100%",fontSize:20,marginTop:12},children:nr}),(0,o.jsx)(L.Z,{style:{height:"120px",width:"100%",marginTop:12},color:h?"green":"red",children:(0,o.jsx)(Be.Z,{style:{height:"100px"},status:h?"processing":"error",text:h?(0,o.jsx)(A.Z.Title,{style:{color:h?"blue":"red"},children:"\u4E32\u53E3\u5DF2\u8FDE\u63A5"}):(0,o.jsx)(A.Z.Title,{children:"\u4E32\u53E3\u672A\u8FDE\u63A5"})})})]}),(0,o.jsx)(W.Z,{span:8,style:{justifyContent:"flex-start",flexDirection:"column",display:"flex",borderRadius:2,paddingLeft:8,paddingRight:8,height:"100%"},children:(0,o.jsx)(L.Z,{title:"\u65F6\u95F4\u7EBF",children:(0,o.jsx)(ke,{mode:"left",items:le,reverse:!0})})}),(0,o.jsxs)(W.Z,{span:10,style:{justifyContent:"flex-start",flexDirection:"column",display:"flex",borderRadius:2,paddingLeft:8,paddingRight:8,height:"100%"},children:[(0,o.jsx)(L.Z,{title:"\u5F53\u524D\u8BBE\u5907ID",children:(0,o.jsx)(A.Z.Title,{children:ae})}),(0,o.jsx)(L.Z,{title:"\u72B6\u6001",style:{marginTop:12},children:(0,o.jsx)(A.Z.Title,{style:{color:"green"},children:w})})]})]})},ar=tr}}]);
